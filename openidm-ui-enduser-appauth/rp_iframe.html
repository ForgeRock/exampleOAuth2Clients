<script>
    var stat = "unchanged";
    var queryString = decodeURIComponent(window.location.search.substring(1)); // includes '?'
    var mes = queryString.split('=')[1];
    var targetOrigin = "http://am-service.sample.svc.cluster.local";

    function check_session() {
        var win = window.parent.document.getElementById("op_iframe").contentWindow;
        win.postMessage( mes, targetOrigin);
    }

    function setTimer() {
        check_session();
        setInterval("check_session()",3*1000);
    }

    window.addEventListener("message", receiveMessage, false);

    function receiveMessage(e) {
        if (e.origin !== targetOrigin) {
            return;
        }
        stat = e.data;

        if (stat === "changed") {
            console.log("then take the actions below...");
        }
    }

    setTimer();
</script>
